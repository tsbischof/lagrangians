(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    177090,       4680]
NotebookOptionsPosition[    175941,       4642]
NotebookOutlinePosition[    176277,       4657]
CellTagsIndexPosition[    176234,       4654]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EquationsOfMotion", "[", 
    RowBox[{"L_", ",", "vars_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"equations", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "vars", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"L", ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "\[Equal]", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}]}], "]"}], 
            ",", "t"}], "]"}]}]}], "]"}]}], "]"}], ";", 
     RowBox[{"results", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Expand", "[", "equations", "]"}], "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"x", ",", 
              RowBox[{"D", "[", 
               RowBox[{"x", ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], ",", 
            "vars"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "vars", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"results", ",", 
         RowBox[{
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"vars", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}]}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "results", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyNorm", "[", "r_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"result", " ", "=", "0"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "r", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"result", "=", 
        RowBox[{"result", "+", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}]}]}], "]"}], ";", 
     "result"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.485825127618664*^9, 3.485825144943345*^9}, {
   3.485825219418188*^9, 3.485825281210636*^9}, {3.485826032886249*^9, 
   3.485826178878983*^9}, 3.485826428568575*^9, {3.48582692231846*^9, 
   3.48582692531711*^9}, {3.485827828920486*^9, 3.485827832228448*^9}, {
   3.485827893931818*^9, 3.485827906425414*^9}, {3.4858361371888103`*^9, 
   3.48583613733764*^9}, {3.485837349282503*^9, 3.485837351705883*^9}, {
   3.4858375889587297`*^9, 3.4858375927099333`*^9}, 3.48591502016737*^9, 
   3.4859150563289137`*^9, {3.4859151311073303`*^9, 3.485915206578086*^9}, {
   3.485915259529451*^9, 3.485915259891967*^9}, {3.487382655459413*^9, 
   3.487382669883849*^9}, {3.487382704459874*^9, 3.487382769885955*^9}, {
   3.4873829544344788`*^9, 3.48738296388992*^9}, {3.487383202312725*^9, 
   3.487383208431983*^9}, {3.48738327964462*^9, 3.487383283263842*^9}, {
   3.48743068928662*^9, 3.487430694575748*^9}, {3.487433588645453*^9, 
   3.487433592223222*^9}, 3.487433734033598*^9, {3.4874345062474546`*^9, 
   3.487434530623208*^9}, {3.48743502933355*^9, 3.487435040082629*^9}, {
   3.493939336369564*^9, 3.493939387821953*^9}, {3.4939409969304323`*^9, 
   3.493941003752096*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Stick", " ", "on", " ", "a", " ", "spring"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "k", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "t", "]"}], "-", "r0"}], ")"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], "*", "g", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "t", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ")"}]}], ")"}]}], 
      "+", 
      RowBox[{"m2", "*", "g", "*", "l", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"r", "'"}], "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], ")"}], "^", 
          "2"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "m2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "*", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], ")"}], "^", "2"}], 
         "+", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"r", "'"}], "[", "t", "]"}], "*", "l", "*", 
          RowBox[{
           RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", "*", "l", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}], "*", 
          RowBox[{"r", "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EquationsOfMotion", "[", 
    RowBox[{
     RowBox[{"T", "-", "U"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.485658317073111*^9, 3.4856583975857983`*^9}, {
   3.4856584326362534`*^9, 3.485658633676188*^9}, {3.485658741430072*^9, 
   3.485658887804174*^9}, {3.485659013514534*^9, 3.4856590256342*^9}, {
   3.485660412349802*^9, 3.485660433236212*^9}, {3.485660475380664*^9, 
   3.485660594283758*^9}, {3.485660676020018*^9, 3.485660762526025*^9}, {
   3.485660803226452*^9, 3.485660876098757*^9}, {3.4856609437433577`*^9, 
   3.485661179150996*^9}, {3.4856613079109573`*^9, 3.4856614679347363`*^9}, {
   3.485661653360467*^9, 3.48566169769011*^9}, {3.485661962299911*^9, 
   3.4856619656569023`*^9}, {3.485695466487756*^9, 3.4856954866449633`*^9}, 
   3.4857296237127666`*^9, {3.485729802114038*^9, 3.485729817953187*^9}, {
   3.4857303584647408`*^9, 3.485730404974506*^9}, {3.48573044113831*^9, 
   3.485730448477564*^9}, {3.485730744795251*^9, 3.485730745696887*^9}, {
   3.485731326973711*^9, 3.485731437304769*^9}, {3.485731503846492*^9, 
   3.485731554756583*^9}, {3.485742675889145*^9, 3.485742718586602*^9}, {
   3.485822895355055*^9, 3.4858229247530622`*^9}, {3.485822981038961*^9, 
   3.485823066676189*^9}, {3.485823115196652*^9, 3.485823118428299*^9}, {
   3.485825262802822*^9, 3.485825266135929*^9}, {3.4858255022462673`*^9, 
   3.4858255143799753`*^9}, {3.4858259175732317`*^9, 3.485825920422649*^9}, {
   3.485826064262171*^9, 3.4858260655564823`*^9}, {3.485826946702578*^9, 
   3.485826949154283*^9}, {3.485827778091508*^9, 3.485827797441481*^9}, {
   3.485829358745392*^9, 3.485829360441235*^9}, {3.485833128611596*^9, 
   3.485833135215068*^9}, 3.485833201990337*^9, {3.485833356922555*^9, 
   3.4858333754194813`*^9}, {3.485833489967374*^9, 3.4858335020366077`*^9}, {
   3.4858341838749228`*^9, 3.4858342157545547`*^9}, {3.4858342553206663`*^9, 
   3.48583431602418*^9}, {3.485834353434894*^9, 3.4858343557075*^9}, {
   3.4858343989124327`*^9, 3.485834456682168*^9}, {3.485834496996681*^9, 
   3.485834506854806*^9}, {3.485834567899973*^9, 3.485834634995144*^9}, {
   3.485835157160345*^9, 3.4858352466338243`*^9}, {3.485836135065176*^9, 
   3.4858361396184797`*^9}, {3.485836464750225*^9, 3.4858364659642277`*^9}, {
   3.4858372480534678`*^9, 3.485837253765547*^9}, {3.485837524920382*^9, 
   3.4858375273377647`*^9}, {3.485837933692999*^9, 3.485837935861973*^9}, {
   3.485913393926805*^9, 3.485913404789433*^9}, 3.485913901341243*^9, {
   3.4859145098739643`*^9, 3.4859145109518948`*^9}, {3.487387293422802*^9, 
   3.487387302236525*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "g", " ", 
        SuperscriptBox["m1", "2"]}], "-", 
       RowBox[{"3", " ", "g", " ", "m1", " ", "m2"}], "-", 
       RowBox[{"g", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"2", " ", "k", " ", "m1", " ", "r0"}], "+", 
       RowBox[{"k", " ", "m2", " ", "r0"}], "+", 
       RowBox[{"2", " ", "g", " ", 
        SuperscriptBox["m1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "g", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"g", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"g", " ", 
        SuperscriptBox["m2", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
       RowBox[{"k", " ", "m2", " ", "r0", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"r", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "m1"}], "+", "m2", "-", 
             RowBox[{"m2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
                  RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"2", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
       "+", 
       RowBox[{"2", " ", "l", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], " ", 
        RowBox[{"r", "[", "t", "]"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "g", " ", 
         SuperscriptBox["m1", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "g", " ", "m1", " ", "m2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"g", " ", "m1", " ", "m2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"g", " ", 
         SuperscriptBox["m2", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"k", " ", "m2", " ", "r0", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"k", " ", "m2", " ", 
         RowBox[{"r", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["r", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"2", " ", "l", " ", "m1", " ", "m2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Phi]", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
        RowBox[{"k", " ", "r0"}], "+", 
        RowBox[{"k", " ", 
         RowBox[{"r", "[", "t", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
        RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], 
     RowBox[{"l", " ", "m1"}]]}], ",", 
   RowBox[{
    RowBox[{"r", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["r", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.487387300853532*^9, 3.487387302653432*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Spring", " ", "on", " ", "a", " ", "stick"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "*", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "'"}], "[", "t", "]"}]}], ")"}], "^",
         "2"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "m2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"r", "'"}], "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Phi]", "2"], "'"}], "[", "t", "]"}]}], ")"}], 
          "^", "2"}], "+", 
         RowBox[{"2", "*", "l", "*", 
          RowBox[{"r", "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "'"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "2"], "'"}], "[", "t", "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], "*", "g", "*", "l", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{"m2", "*", "g", "*", 
       RowBox[{"r", "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "k", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "t", "]"}], "-", "r0"}], ")"}], "^", "2"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"EquationsOfMotion", "[", 
    RowBox[{
     RowBox[{"T", "-", "U"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.48591452453585*^9, 3.485914856517626*^9}, {
  3.485914932394363*^9, 3.4859149330415897`*^9}, {3.485915232890236*^9, 
  3.485915251384611*^9}, {3.4859152858643217`*^9, 3.4859152886398897`*^9}, {
  3.485915410379977*^9, 3.485915453549603*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Double", " ", "pendulum"}], ",", " ", 
    RowBox[{
    "with", " ", "springs", " ", "instead", " ", "of", " ", "sticks"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["r", "1"], "[", "t", "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["r", "1"], "[", "t", "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["r", "1"], "[", "t", "]"}], "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "2"], "[", "t", "]"}], "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}]}], "*", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "2"], "[", "t", "]"}], "*", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}]}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "m1", "*", 
       RowBox[{"MyNorm", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r1", ",", "t"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "m2", "*", 
       RowBox[{"MyNorm", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r2", ",", "t"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], "*", "g", "*", 
       RowBox[{
        SubscriptBox["r", "1"], "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{"m2", "*", "g", "*", 
       RowBox[{
        SubscriptBox["r", "2"], "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["k", "1"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}], "-", 
          SubscriptBox["r", "10"]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["k", "2"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "2"], "[", "t", "]"}], "-", 
          SubscriptBox["r", "20"]}], ")"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EquationsOfMotion", "[", 
    RowBox[{
     RowBox[{"T", "-", "U"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "1"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["r", "2"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], ",", 
       RowBox[{
        SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.487275946829466*^9, 3.4872760722577868`*^9}, {
  3.487276115859799*^9, 3.4872764027891293`*^9}, {3.487276448167869*^9, 
  3.4872765392415333`*^9}, {3.4872770861855392`*^9, 3.4872771200118513`*^9}, {
  3.48738749572901*^9, 3.487387495854988*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"m1", " ", "m2"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["k", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "10"], "-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], " ", 
        SubscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "20"], "-", 
          RowBox[{
           SubscriptBox["r", "2"], "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "g", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], ")"}]}], 
             "]"}], "2"]}], "+", 
          RowBox[{"m1", " ", 
           RowBox[{
            SubscriptBox["r", "2"], "[", "t", "]"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[Phi]", "2"], "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
      ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "m1"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "g"}], " ", "m1"}], "-", 
       RowBox[{"g", " ", "m2"}], "+", 
       RowBox[{"g", " ", "m1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"g", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "10"], "-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "20"], "-", 
          RowBox[{
           SubscriptBox["r", "2"], "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{"m1", " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "1"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"m1", " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", "t", "]"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "g"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"m2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "20"], "-", 
          RowBox[{
           SubscriptBox["r", "2"], "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "m1", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Phi]", "1"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "2"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"m1", " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", "t", "]"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["k", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "10"], "-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "m1", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Phi]", "2"], "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.487387497975279*^9, 3.487387500930458*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"many", " ", "pendula"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nmasses", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["m", "i"], "*", "g", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["l", "j"], "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Phi]", "j"], "[", "t", "]"}], "]"}]}], ")"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nmasses"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], "*", 
        SubscriptBox["m", "i"], "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["l", "j"], "*", 
           SubscriptBox["l", "k"], "*", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "j"], "'"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "k"], "'"}], "[", "t", "]"}], "*", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Phi]", "j"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["\[Phi]", "k"], "[", "t", "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "i"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "i"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nmasses"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"T", "-", "U"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<=", "nmasses"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"vars", ",", 
        RowBox[{
         SubscriptBox["\[Phi]", "i"], "[", "t", "]"}]}], "]"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"EquationsOfMotion", "[", 
    RowBox[{"L", ",", "vars"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.485737817627974*^9, 3.48573793357687*^9}, {
   3.485737974650384*^9, 3.4857381424881277`*^9}, {3.4857381977366953`*^9, 
   3.485738256668421*^9}, {3.485738369306501*^9, 3.485738436340246*^9}, {
   3.48573851755398*^9, 3.485738604869731*^9}, {3.485738754992309*^9, 
   3.485738766128796*^9}, {3.485738907330496*^9, 3.485739001997282*^9}, {
   3.4857390477370872`*^9, 3.485739082891745*^9}, {3.4857391284305*^9, 
   3.485739166154706*^9}, {3.485739199901154*^9, 3.485739235414968*^9}, {
   3.485739313586212*^9, 3.4857394817338657`*^9}, {3.485739557969967*^9, 
   3.485739568848832*^9}, {3.485739684220414*^9, 3.485739687743717*^9}, {
   3.485739841078524*^9, 3.485739854632481*^9}, {3.485739928733678*^9, 
   3.485739942480968*^9}, {3.4857400468479633`*^9, 3.485740086441051*^9}, {
   3.485740183777255*^9, 3.485740201890956*^9}, {3.4857402350656843`*^9, 
   3.485740247665312*^9}, {3.485740303755764*^9, 3.48574030390275*^9}, {
   3.4857403470951557`*^9, 3.48574035734762*^9}, {3.485740412137821*^9, 
   3.4857404560978603`*^9}, {3.48574064869765*^9, 3.485740655466889*^9}, {
   3.485740760455052*^9, 3.485740760702066*^9}, {3.485740807142598*^9, 
   3.485740828574624*^9}, {3.485741026339486*^9, 3.485741070490239*^9}, 
   3.485741174056508*^9, {3.485741205869789*^9, 3.4857412091241913`*^9}, {
   3.485741398877962*^9, 3.4857413990987787`*^9}, {3.485741758943576*^9, 
   3.485741760002228*^9}, {3.4857418263561974`*^9, 3.485741827927394*^9}, {
   3.485821435148293*^9, 3.485821435450605*^9}, {3.485822220247106*^9, 
   3.48582225242277*^9}, 3.485822408159338*^9, {3.48582264028933*^9, 
   3.485822642388146*^9}, {3.4858226919462013`*^9, 3.485822699294207*^9}, {
   3.4858234634960413`*^9, 3.485823464865843*^9}, {3.48582530180014*^9, 
   3.485825312482006*^9}, {3.485825409345187*^9, 3.4858254192939167`*^9}, {
   3.485826214170704*^9, 3.485826214269463*^9}, {3.4858279240574827`*^9, 
   3.485827924626622*^9}, {3.485829384310334*^9, 3.485829384429648*^9}, {
   3.485829417395443*^9, 3.485829417710829*^9}, {3.4858304897402687`*^9, 
   3.485830489877845*^9}, {3.4858373811438017`*^9, 3.485837421663801*^9}, {
   3.485873654560285*^9, 3.4858736812817183`*^9}, {3.485873725166044*^9, 
   3.4858737488552313`*^9}, {3.493939121700406*^9, 3.4939391221406727`*^9}, 
   3.493939178532296*^9, 3.493939377660492*^9, {3.493947880787283*^9, 
   3.4939479377828197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1", " ", "pendulum"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], 
       SubscriptBox["l", "1"]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4939479162057343`*^9, 3.493947921039195*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"2", " ", "pendula"}], "*)"}], 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "g", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["m", "1"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
          SubscriptBox["m", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
             SubscriptBox["l", "1"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
            RowBox[{
             SubscriptBox["l", "2"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 SubscriptBox["\[Phi]", "2"], ")"}], "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
           ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SubscriptBox["l", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
            " ", 
            SubscriptBox["m", "2"]}]}], ")"}]}], ")"}]}]}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "2"], ")"}], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{
              SubscriptBox["l", "1"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}],
           "+", 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{
              SubscriptBox["l", "1"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
              SubscriptBox["l", "2"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Phi]", "2"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
            ")"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["l", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"]}]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "1"], ")"}], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Phi]", "2"], ")"}], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.493947901758176*^9, 3.493947909360506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"3", " ", "pendula"}], "*)"}], 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "1"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "g", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["m", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["m", "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"], 
             " ", 
             SubscriptBox["m", "3"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
          SubscriptBox["m", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], "+", 
               
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
                SubscriptBox["l", "1"], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   SubscriptBox["\[Phi]", "1"], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
               RowBox[{
                SubscriptBox["l", "2"], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   SubscriptBox["\[Phi]", "2"], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
              ")"}]}], "+", 
            RowBox[{
             SubscriptBox["m", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], "+", 
               
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
                SubscriptBox["l", "1"], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   SubscriptBox["\[Phi]", "1"], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
               RowBox[{
                SubscriptBox["l", "2"], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   SubscriptBox["\[Phi]", "2"], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
                SubscriptBox["l", "3"], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox[
                   SubscriptBox["\[Phi]", "3"], "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
              ")"}]}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SubscriptBox["l", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
            " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "2"], "+", 
              SubscriptBox["m", "3"]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["m", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "2"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                "2"], " ", 
               SubscriptBox["m", "3"]}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
    ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "2"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
              "+", 
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "2"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "2"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["l", "3"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "3"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
         SubscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "2"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "2"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}], "+", 
           RowBox[{
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "2"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "2"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "3"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "3"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SubscriptBox["l", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "2"], "+", 
             SubscriptBox["m", "3"]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], ",", 
    
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "3"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["m", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
              SubscriptBox["l", "1"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "1"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
             RowBox[{
              SubscriptBox["l", "2"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "2"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}],
           "+", 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"g", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
              SubscriptBox["l", "1"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "1"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["l", "2"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "2"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
              SubscriptBox["l", "3"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "3"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
            ")"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["l", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "2"], "+", 
             SubscriptBox["m", "3"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], ",", 
    
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "1"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "1"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "2"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "2"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "3"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "3"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.485837396396673*^9, 3.485837401770597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"4", " ", "pendula"}], "*)"}], 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "1"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "g", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"], 
            " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "3"], "+", 
              SubscriptBox["m", "4"]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "3"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                "2"], " ", 
               SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
         SubscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "3"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                "2"], " ", 
               SubscriptBox["m", "4"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{
               SubscriptBox["l", "2"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "2"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["m", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}], "+", 
              RowBox[{
               SubscriptBox["m", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "+", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["l", "1"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "2"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["m", "1"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "3"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                "2"], " ", 
               SubscriptBox["m", "4"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["m", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}], "+", 
              RowBox[{
               SubscriptBox["m", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
         SubscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "3"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                "2"], " ", 
               SubscriptBox["m", "4"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["l", "1"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "1"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["l", "2"], " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox["\[Phi]", "2"], "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["m", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}], "+", 
              RowBox[{
               SubscriptBox["m", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "+", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["l", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "3"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], " ", 
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["l", "3"], " ", 
            SubscriptBox["m", "2"], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               SubscriptBox["\[Phi]", "3"], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
           RowBox[{
            SubscriptBox["l", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "2"], "+", 
              SubscriptBox["m", "3"]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox[
               SubscriptBox["\[Phi]", "4"], "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
        "+", 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["m", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], " ", 
                  
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}], "-", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], " ", 
               
               SubscriptBox["m", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "+", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"4", " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["m", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}], "+", 
              RowBox[{
               SubscriptBox["m", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}]}], 
                 "+", 
                 RowBox[{"g", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "1"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SubscriptBox["l", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  " ", 
                  SubscriptBox["l", "4"], " ", 
                  SuperscriptBox[
                   RowBox[{
                    SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        SubscriptBox["l", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Phi]", "4"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], " ", 
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["l", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "3"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                RowBox[{
                 SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], " ", 
              SubscriptBox["l", "4"], " ", 
              SubscriptBox["m", "4"], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Phi]", "4"], "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}],
           "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "+", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 SubscriptBox["l", "1"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 SubscriptBox["l", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                RowBox[{"4", " ", 
                 SubscriptBox["l", "3"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
               ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], "+", 
                RowBox[{"g", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "+", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}]}], 
                "+", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 SubscriptBox["l", "1"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "1"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 SubscriptBox["l", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "2"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                RowBox[{"4", " ", 
                 SubscriptBox["l", "3"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "3"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                   RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                 " ", 
                 SubscriptBox["l", "4"], " ", 
                 SuperscriptBox[
                  RowBox[{
                   SuperscriptBox[
                    SubscriptBox["\[Phi]", "4"], "\[Prime]",
                    MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        SubscriptBox["l", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "-", 
              RowBox[{
               SubscriptBox["\[Phi]", "2"], "[", "t", "]"}]}], "]"}], "2"], 
           " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "-", 
                 RowBox[{
                  SubscriptBox["\[Phi]", "3"], "[", "t", "]"}]}], "]"}], "2"],
               " ", 
              SubscriptBox["m", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                SubscriptBox["m", "4"]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "3"], "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "-", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "4"], "[", "t", "]"}]}], "]"}], 
                  "2"], " ", 
                 SubscriptBox["m", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "1"], "'"}], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "2"], "'"}], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "3"], "'"}], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Phi]", "4"], "[", "t", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "4"], "'"}], "[", "t", "]"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.485830479178069*^9, 3.485830486080991*^9}, {
  3.485837428687327*^9, 3.4858374502168827`*^9}, {3.485837952101803*^9, 
  3.4858379663788548`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Bar", " ", "with", " ", "two", " ", "springs"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myr1", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "0"], ",", 
        SubscriptBox["y", "0"]}], "}"}], "-", 
      RowBox[{
       RowBox[{"b", "/", "2"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}], ",", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], "}"}]}], 
      "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "1"], "[", "t", "]"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}]}], 
        "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myr2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "0"], ",", 
        SubscriptBox["y", "0"]}], "}"}], "+", 
      RowBox[{
       RowBox[{"b", "/", "2"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}], ",", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}]}], "}"}]}], 
      "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "2"], "[", "t", "]"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}]}], 
        "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Izz", "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}]}], ")"}], "*", 
        RowBox[{
         SubscriptBox["m", "3"], "/", 
         RowBox[{"(", 
          RowBox[{"b", "*", "h"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "b"}], "/", "2"}], ",", 
         RowBox[{"b", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", "h"}], "/", "2"}], ",", 
         RowBox[{"h", "/", "2"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["m", "1"], "*", 
       RowBox[{"MyNorm", "[", 
        RowBox[{"D", "[", 
         RowBox[{"myr1", ",", "t"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["m", "2"], "*", 
       RowBox[{"MyNorm", "[", 
        RowBox[{"D", "[", 
         RowBox[{"myr2", ",", "t"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{"Izz", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["x", "0"], "^", "2"}], "+", 
            RowBox[{
             SubscriptBox["y", "0"], "^", "2"}]}], ")"}], "*", 
          SubscriptBox["m", "3"]}]}], ")"}], "*", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "^", "2"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["k", "1"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", "t", "]"}], "-", 
          SubscriptBox["r", "10"]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       SubscriptBox["k", "2"], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "2"], "[", "t", "]"}], "-", 
          SubscriptBox["r", "20"]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{
       SubscriptBox["m", "1"], "*", "g", "*", 
       RowBox[{
        SubscriptBox["r", "1"], "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       SubscriptBox["m", "2"], "*", "g", "*", 
       RowBox[{
        SubscriptBox["r", "2"], "[", "t", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       SubscriptBox["m", "3"], "*", "g", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "0"], "^", "2"}], "+", 
         RowBox[{
          SubscriptBox["y", "0"], "^", "2"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "]"}], ")"}]}]}]}], 
    ";", 
    RowBox[{"EquationsOfMotion", "[", 
     RowBox[{
      RowBox[{"T", "-", "U"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], ",", 
        RowBox[{
         SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], ",", 
        RowBox[{
         SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], ",", 
        RowBox[{
         SubscriptBox["r", "1"], "[", "t", "]"}], ",", 
        RowBox[{
         SubscriptBox["r", "2"], "[", "t", "]"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.487380433051415*^9, 3.487380545562039*^9}, {
   3.487380640112818*^9, 3.4873807693205347`*^9}, {3.487381278693231*^9, 
   3.487381447219993*^9}, {3.487381530037465*^9, 3.487381665469803*^9}, {
   3.4873817378357286`*^9, 3.4873817516670313`*^9}, {3.4873825388731327`*^9, 
   3.487382595618285*^9}, {3.4873828480001783`*^9, 3.487382946090596*^9}, {
   3.487382979094674*^9, 3.4873829943136044`*^9}, {3.4873830567285147`*^9, 
   3.487383076161154*^9}, {3.487383157166725*^9, 3.4873831578814*^9}, {
   3.487383219987414*^9, 3.487383245012063*^9}, {3.487383275799919*^9, 
   3.487383275942704*^9}, {3.487383419354867*^9, 3.487383439159979*^9}, {
   3.4873837958814783`*^9, 3.487383796173965*^9}, {3.487384018850152*^9, 
   3.487384072693428*^9}, {3.487384132748725*^9, 3.487384181945924*^9}, 
   3.487384581034021*^9, {3.4873849506379642`*^9, 3.4873849591494637`*^9}, {
   3.487385363727963*^9, 3.487385399200259*^9}, {3.487386370943754*^9, 
   3.4873863716031923`*^9}, {3.4873866538711042`*^9, 3.487386695073971*^9}, {
   3.487387268344297*^9, 3.487387269494524*^9}, {3.487387310878027*^9, 
   3.487387466074112*^9}, {3.487387522421569*^9, 3.487387556491577*^9}, {
   3.487430249208747*^9, 3.487430255652729*^9}, {3.48743065731068*^9, 
   3.487430670887192*^9}, {3.487430713429365*^9, 3.4874307135494757`*^9}, {
   3.4874309595681887`*^9, 3.4874309734989567`*^9}, {3.487431005854273*^9, 
   3.487431006227447*^9}, {3.487431116639093*^9, 3.4874311308266563`*^9}, {
   3.4874345422599297`*^9, 3.487434570141345*^9}, {3.487435048803714*^9, 
   3.487435069329398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "3"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4876499740095673`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"r1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "g", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Phi]3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"r1", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"m2", " ", 
       RowBox[{"r2", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "g", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"b", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Phi]3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"r2", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"m3", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["h", "2"], "+", 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x0", "2"], "+", 
            SuperscriptBox["y0", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\[Phi]3", "[", "t", "]"}]}], "\[Equal]", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "g", " ", "m3", " ", 
          SuperscriptBox["x0", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "g", " ", "m3", " ", 
          SuperscriptBox["y0", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"4", " ", "b", " ", "m1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"4", " ", "b", " ", "m2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", "b", " ", "m2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"r2", "[", "t", "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Phi]2", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", "b", " ", "m1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "b", " ", "m2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "b", " ", "m1", " ", 
          RowBox[{"r1", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
               RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["\[Phi]1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
               RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "b", " ", "m2", " ", 
          RowBox[{"r2", "[", "t", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "m1", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "m2", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"k1", " ", "r10"}], "+", 
       RowBox[{"g", " ", "m1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"r1", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "k1"}], "+", 
          RowBox[{"m1", " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Phi]1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
      "\[Equal]", 
      RowBox[{
       FractionBox["1", "2"], " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "g"}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Phi]3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"k2", " ", "r20"}], "+", 
       RowBox[{"g", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"r2", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "b", " ", "m2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "b", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
      RowBox[{
       RowBox[{"k2", " ", 
        RowBox[{"r2", "[", "t", "]"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseequations", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a10", "*", " ", 
       RowBox[{"(", 
        RowBox[{"a1", "+", 
         RowBox[{"a11", "*", 
          RowBox[{
           SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"a12", "*", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"a13", "*", " ", 
       RowBox[{"(", 
        RowBox[{"a2", "+", 
         RowBox[{"a14", "*", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"a15", "*", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{"a3", "\[Equal]", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"a4", "+", 
         RowBox[{"a16", "*", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"a17", "*", " ", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"a18", 
          RowBox[{"(", 
           RowBox[{"a5", "+", " ", 
            RowBox[{"a19", "*", 
             RowBox[{
              SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"a20", "*", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"a21", "*", " ", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"a22", "*", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"a6", "\[Equal]", 
      RowBox[{
       FractionBox["1", "2"], " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"a7", "+", 
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["r1", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", " ", 
         RowBox[{"a23", "*", 
          RowBox[{
           SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"a8", "+", 
       RowBox[{"a24", "*", " ", 
        RowBox[{
         SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
      RowBox[{"a9", "+", 
       RowBox[{"m2", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", 
          RowBox[{
           SuperscriptBox["r2", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1", "->", 
      RowBox[{
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["r1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]}], ",", 
     RowBox[{"a2", "->", 
      RowBox[{
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["r2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"a3", "->", 
      RowBox[{"m3", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["h", "2"], "+", 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x0", "2"], "+", 
            SuperscriptBox["y0", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\[Phi]3", "[", "t", "]"}]}]}], ",", 
     RowBox[{"a4", "->", 
      RowBox[{
       RowBox[{"4", " ", "g", " ", "m3", " ", 
        SuperscriptBox["x0", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", "g", " ", "m3", " ", 
        SuperscriptBox["y0", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"4", " ", "b", " ", "m1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["r1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"4", " ", "b", " ", "m2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["r2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"2", " ", "b", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"r2", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]}], ",", 
     RowBox[{"a5", "->", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ",", 
     RowBox[{"a6", "->", 
      RowBox[{
       RowBox[{"k1", " ", "r10"}], "+", 
       RowBox[{"g", " ", "m1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"r1", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "k1"}], "+", 
          RowBox[{"m1", " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Phi]1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
         ")"}]}]}]}], ",", 
     RowBox[{"a7", "\[Rule]", 
      RowBox[{
       RowBox[{"2", " ", "g"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]}], ",", 
     RowBox[{"a8", "->", 
      RowBox[{
       RowBox[{"k2", " ", "r20"}], "+", 
       RowBox[{"g", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"r2", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "b", " ", "m2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}]}], ",", 
     RowBox[{"a9", "->", 
      RowBox[{"k2", " ", 
       RowBox[{"r2", "[", "t", "]"}]}]}], ",", 
     RowBox[{"a10", "->", 
      RowBox[{"m1", " ", 
       RowBox[{"r1", "[", "t", "]"}]}]}], ",", 
     RowBox[{"a11", "->", 
      RowBox[{"2", " ", 
       RowBox[{"r1", "[", "t", "]"}]}]}], " ", ",", 
     RowBox[{"a12", "->", 
      RowBox[{"b", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"a13", "->", 
      RowBox[{"m2", " ", 
       RowBox[{"r2", "[", "t", "]"}]}]}], ",", 
     RowBox[{"a14", "->", 
      RowBox[{"2", " ", 
       RowBox[{"r2", "[", "t", "]"}]}]}], ",", 
     RowBox[{"a15", "->", 
      RowBox[{"b", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], " ", ",", 
     RowBox[{"a16", "->", 
      RowBox[{"2", " ", "b", " ", "m1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], " ", ",", 
     RowBox[{"a17", "->", 
      RowBox[{"2", " ", "b", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"a18", "->", 
      RowBox[{"2", " ", "b", " ", "m1", " ", 
       RowBox[{"r1", "[", "t", "]"}]}]}], " ", ",", 
     RowBox[{"a19", "->", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
        RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}], ",", 
     RowBox[{"a20", "->", 
      RowBox[{"2", " ", "b", " ", "m2", " ", 
       RowBox[{"r2", "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"a21", "->", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "m1"}]}], ",", 
     RowBox[{"a22", "->", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "m2"}]}], " ", ",", 
     RowBox[{"a23", "->", 
      RowBox[{"b", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"a24", "->", 
      RowBox[{
       FractionBox["1", "2"], " ", "b", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vars", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], ",", 
    RowBox[{
     SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], ",", 
    RowBox[{
     SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], ",", 
    RowBox[{
     SuperscriptBox["r1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], ",", 
    RowBox[{
     SuperscriptBox["r2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solved", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"baseequations", ",", "vars"}], "]"}], "/.", "subs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myequations", "\[Equal]", "baseequations"}], "/.", 
  "subs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solved", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"AppendTo", "[", 
     RowBox[{
      RowBox[{"solved", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "3"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "1"], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["r", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "2"], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["r", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"solved", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"solved", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"r1", "[", "t", "]"}], "\[NotEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{"r2", "[", "t", "]"}], "\[NotEqual]", "0"}], ",", 
     RowBox[{"m1", "\[NotEqual]", "0"}], ",", 
     RowBox[{"m2", "\[NotEqual]", "0"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.487646363451314*^9, 3.4876464442411737`*^9}, {
   3.487646490478455*^9, 3.4876465049881907`*^9}, {3.487646585121566*^9, 
   3.4876466676621313`*^9}, {3.487646699588932*^9, 3.487646893281453*^9}, {
   3.4876469650428*^9, 3.48764709506877*^9}, {3.48764714190065*^9, 
   3.487647178625464*^9}, {3.48764724977847*^9, 3.487647250633215*^9}, {
   3.487647755581115*^9, 3.487648129267302*^9}, 3.4876482026571703`*^9, {
   3.487648237790401*^9, 3.487648300679234*^9}, {3.48764834790212*^9, 
   3.4876483494515057`*^9}, {3.487648387851549*^9, 3.487648562736877*^9}, {
   3.487648784783601*^9, 3.487648787580122*^9}, {3.4876488354016647`*^9, 
   3.487648910360201*^9}, {3.487648959376383*^9, 3.487649009520915*^9}, {
   3.487649102849443*^9, 3.4876491416773*^9}, {3.4876498574859056`*^9, 
   3.487649888571372*^9}, {3.487649984219226*^9, 3.487649989179285*^9}, {
   3.487650048086997*^9, 3.487650141633937*^9}, {3.487725563566226*^9, 
   3.487725606067896*^9}, {3.487726057342887*^9, 3.487726093309164*^9}, {
   3.487726302019164*^9, 3.487726328899104*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], ",", 
   RowBox[{
    SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], ",", 
   RowBox[{
    SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], ",", 
   RowBox[{
    SuperscriptBox["r1", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], ",", 
   RowBox[{
    SuperscriptBox["r2", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.487648203549994*^9, 3.4876482384611998`*^9, {3.487648283052637*^9, 
   3.487648301384901*^9}, 3.487648350029581*^9, {3.487648391248191*^9, 
   3.4876485631719437`*^9}, 3.487648787926544*^9, {3.487648853839634*^9, 
   3.4876488869544573`*^9}, {3.487648964505815*^9, 3.487649010478511*^9}, {
   3.487649111984087*^9, 3.487649142330182*^9}, {3.487649865004538*^9, 
   3.487649888897648*^9}, {3.487649977231741*^9, 3.48764999024815*^9}, {
   3.487650061972088*^9, 3.4876501421693*^9}, 3.4876502462499332`*^9, {
   3.487725558531684*^9, 3.4877256064458303`*^9}, {3.487726058034931*^9, 
   3.487726093622959*^9}, {3.487726311877087*^9, 3.48772631815193*^9}, 
   3.487726416427425*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.487648203549994*^9, 3.4876482384611998`*^9, {3.487648283052637*^9, 
   3.487648301384901*^9}, 3.487648350029581*^9, {3.487648391248191*^9, 
   3.4876485631719437`*^9}, 3.487648787926544*^9, {3.487648853839634*^9, 
   3.4876488869544573`*^9}, {3.487648964505815*^9, 3.487649010478511*^9}, {
   3.487649111984087*^9, 3.487649142330182*^9}, {3.487649865004538*^9, 
   3.487649888897648*^9}, {3.487649977231741*^9, 3.48764999024815*^9}, {
   3.487650061972088*^9, 3.4876501421693*^9}, 3.4876502462499332`*^9, {
   3.487725558531684*^9, 3.4877256064458303`*^9}, {3.487726058034931*^9, 
   3.487726093622959*^9}, {3.487726311877087*^9, 3.48772631815193*^9}, 
   3.487726416497081*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "g", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["r1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"r1", "[", "t", "]"}]}]]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
        RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "48"}], " ", "b", " ", "g", " ", "m1", " ", 
         SuperscriptBox["m2", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}]}], "-", 
        RowBox[{"48", " ", "b", " ", "k2", " ", "m1", " ", "m2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"r2", "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"8", " ", "m1", " ", "m2", " ", "m3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"12", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x0", "2"], "+", 
              SuperscriptBox["y0", "2"]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"\[Phi]3", "[", "t", "]"}]}], "+", 
        RowBox[{"48", " ", "b", " ", 
         SuperscriptBox["m1", "2"], " ", "m2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"r1", "[", "t", "]"}], "2"], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Phi]1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"48", " ", "b", " ", "m1", " ", "m2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "r10"}], "+", 
           RowBox[{"g", " ", "m1", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"r1", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "k1"}], "+", 
              RowBox[{"m1", " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox["\[Phi]1", "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], "2"]}]}], 
             ")"}]}]}], ")"}]}], "-", 
        RowBox[{"24", " ", "m1", " ", "m2", " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "g", " ", "m3", " ", 
            SuperscriptBox["x0", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4", " ", "g", " ", "m3", " ", 
            SuperscriptBox["y0", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"4", " ", "b", " ", "m1", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["r1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"4", " ", "b", " ", "m2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["r2", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]2", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"2", " ", "b", " ", "m2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"r2", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]2", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
        "-", 
        RowBox[{"24", " ", "b", " ", 
         SuperscriptBox["m1", "2"], " ", "m2", " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "g", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{
             SuperscriptBox["r1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]1", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"b", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]3", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
        "+", 
        RowBox[{"24", " ", "b", " ", "m1", " ", 
         SuperscriptBox["m2", "2"], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "g", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{
             SuperscriptBox["r2", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]2", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "-", 
           RowBox[{"b", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]3", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
        "+", 
        RowBox[{"24", " ", "b", " ", 
         SuperscriptBox["m1", "2"], " ", "m2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "g"}], "+", 
           RowBox[{"b", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]3", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
        "+", 
        RowBox[{"48", " ", "b", " ", "m1", " ", "m2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
           RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", " ", "r20"}], "+", 
           RowBox[{"g", " ", "m2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"m2", " ", 
            RowBox[{"r2", "[", "t", "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]2", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", "b", " ", "m2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
              RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Phi]3", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}],
        ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"6", " ", "m1", " ", 
      RowBox[{"r1", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SuperscriptBox["b", "2"], " ", "m1", " ", "m2", " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox["m2", "2"], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", "m1", " ", "m2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox["m2", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", "m1", " ", "m2", " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]1", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox["m2", "2"], " ", 
         RowBox[{"r1", "[", "t", "]"}], " ", 
         RowBox[{"r2", "[", "t", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Phi]2", "[", "t", "]"}], "-", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "]"}], "2"]}]}], ")"}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.487648203549994*^9, 3.4876482384611998`*^9, {3.487648283052637*^9, 
   3.487648301384901*^9}, 3.487648350029581*^9, {3.487648391248191*^9, 
   3.4876485631719437`*^9}, 3.487648787926544*^9, {3.487648853839634*^9, 
   3.4876488869544573`*^9}, {3.487648964505815*^9, 3.487649010478511*^9}, {
   3.487649111984087*^9, 3.487649142330182*^9}, {3.487649865004538*^9, 
   3.487649888897648*^9}, {3.487649977231741*^9, 3.48764999024815*^9}, {
   3.487650061972088*^9, 3.4876501421693*^9}, 3.4876502462499332`*^9, {
   3.487725558531684*^9, 3.4877256064458303`*^9}, {3.487726058034931*^9, 
   3.487726093622959*^9}, {3.487726311877087*^9, 3.48772631815193*^9}, 
   3.48772641651827*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    "ComplexInfinity"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    "ComplexInfinity"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    "ComplexInfinity"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    "ComplexInfinity"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    "ComplexInfinity"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "3"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Phi]", "3"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "2"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.487648203549994*^9, 3.4876482384611998`*^9, {3.487648283052637*^9, 
   3.487648301384901*^9}, 3.487648350029581*^9, {3.487648391248191*^9, 
   3.4876485631719437`*^9}, 3.487648787926544*^9, {3.487648853839634*^9, 
   3.4876488869544573`*^9}, {3.487648964505815*^9, 3.487649010478511*^9}, {
   3.487649111984087*^9, 3.487649142330182*^9}, {3.487649865004538*^9, 
   3.487649888897648*^9}, {3.487649977231741*^9, 3.48764999024815*^9}, {
   3.487650061972088*^9, 3.4876501421693*^9}, 3.4876502462499332`*^9, {
   3.487725558531684*^9, 3.4877256064458303`*^9}, {3.487726058034931*^9, 
   3.487726093622959*^9}, {3.487726311877087*^9, 3.48772631815193*^9}, 
   3.487726416593545*^9}]
}, Open  ]]
},
WindowSize->{749, 750},
WindowMargins->{{Automatic, 1}, {29, Automatic}},
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 4091, 100, 253, "Input"],
Cell[CellGroupData[{
Cell[4661, 124, 5380, 122, 165, "Input"],
Cell[10044, 248, 7000, 189, 352, "Output"]
}, Open  ]],
Cell[17059, 440, 3019, 91, 165, "Input"],
Cell[CellGroupData[{
Cell[20103, 535, 4267, 132, 187, "Input"],
Cell[24373, 669, 7815, 236, 290, "Output"]
}, Open  ]],
Cell[32203, 908, 4975, 110, 231, "Input"],
Cell[37181, 1020, 895, 27, 73, InheritFromParent],
Cell[38079, 1049, 6031, 171, 231, InheritFromParent],
Cell[44113, 1222, 19660, 527, 583, "Input"],
Cell[63776, 1751, 58370, 1479, 1551, "Input"],
Cell[CellGroupData[{
Cell[122171, 3234, 7561, 214, 253, "Input"],
Cell[129735, 3450, 1207, 38, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130979, 3493, 26757, 699, 1148, "Input"],
Cell[157739, 4194, 1326, 28, 31, "Output"],
Cell[159068, 4224, 734, 11, 31, "Output"],
Cell[159805, 4237, 13421, 327, 512, "Output"],
Cell[173229, 4566, 2696, 73, 72, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
